@model YSA.Web.Models.ViewModels.CursoCompletoViewModel
@{
    ViewData["Title"] = Model.Titulo;
}

<style>
    /* Estilos generales */
    body {
        background-color: #EAF3F3;
        color: #fff;
    }

    /* Contenedor principal para centrar el contenido */
    .course-details-container {
        max-width: 900px;
    }

    /* Estilos para la sección de imagen principal */
    .course-hero {
        position: relative;
        width: 100%;
        padding-top: 56.25%; /* Ratio 16:9 para la imagen */
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
        margin-bottom: 40px;
    }

        .course-hero img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .hero-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 20px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
        color: #fff;
    }

        .hero-overlay h1 {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .hero-overlay p {
            font-weight: 300;
        }

    /* Estilos para la tarjeta de precio */
    .price-card {
        border-radius: 12px;
        border: none;
        background-color: #1c1c1c;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    }

    /* Estilos para el botón de acción */
    .btn-action {
        padding: 12px 24px;
        font-size: 1em;
        font-weight: 600;
        border-radius: 8px;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        background-color: #c49900;
        border-color: #c49900;
        color: #000;
    }

        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            background-color: #a38200;
            border-color: #a38200;
        }

    /* Estilos para el acordeón de módulos */
    .accordion-item {
        border: 1px solid #333333;
        border-radius: 8px;
        margin-bottom: 12px;
        overflow: hidden;
        background-color: #1c1c1c;
    }

    .accordion-button {
        background-color: #333333;
        font-weight: 600;
        color: #ffffff;
    }

        .accordion-button:not(.collapsed) {
            background-color: #c49900;
            color: #000000;
            box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.1);
        }

    .list-group-item {
        border: none;
        padding: 15px 20px;
        background-color: #1c1c1c;
        border-bottom: 1px solid #333333;
    }

        .list-group-item:last-child {
            border-bottom: none;
        }

    /* Responsive styles */
    @@media (max-width: 768px) {
        .course-hero {
            border-radius: 0; /* Remove rounded corners on small screens */
            box-shadow: none;
        }
    }
</style>

<div class="container course-details-container">
    <div class="course-hero">
        <img src="@Model.UrlImagen" alt="Imagen del curso: @Model.Titulo" />
        <div class="hero-overlay d-flex flex-column justify-content-end">
            <h1 class="text-white">@Model.Titulo</h1>
            <p class="lead text-white">@Model.DescripcionCorta</p>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-12">
            <div class="card price-card text-center p-3 mb-4">
                <h5 class="fw-bold text-white">Precio del Curso:</h5>
                <h2 class="text-white display-5 fw-bold mb-3">@Model.Precio.ToString("C", System.Globalization.CultureInfo.CreateSpecificCulture("es-VE"))</h2>
                <p style="color:white" class="text-white mb-4"><i class="fas fa-check-circle text-success me-2"></i>Acceso de por vida</p>

                @if (Model.TieneAcceso)
                {
                    <div class="alert alert-success d-flex align-items-center justify-content-center">
                        <i class="fas fa-check-circle me-2"></i>Ya tienes acceso a este curso.
                    </div>
                }
                else if (Model.EstaEnValidacion)
                {
                    <div class="alert alert-info d-flex align-items-center justify-content-center">
                        <i class="fas fa-hourglass-half me-2"></i>Su pago está en proceso de validación.
                    </div>
                }
                else
                {
                    <form asp-controller="Pedido" asp-action="IniciarCompra" method="post">
                        <input type="hidden" name="cursoId" value="@Model.Id" />
                        <button type="submit" style="color:white" class="btn w-100 btn-action">Inscribirse ahora</button>
                    </form>
                }
            </div>
        </div>

        <div class="col-12">
            <h2 class="mb-4 text-black">Acerca de este curso</h2>
            <p class="mb-5 text-black">@Html.Raw(Model.DescripcionLarga)</p>

            @if (Model.TieneAcceso)
            {
                <h2 class="mb-4">Contenido del Curso</h2>
                <div class="accordion" id="acordeonModulos">
                    @if (Model.Modulos != null && Model.Modulos.Any())
                    {
                        @foreach (var modulo in Model.Modulos)
                        {
                            <div class="accordion-item shadow-sm">
                                <h2 class="accordion-header" id="heading_@modulo.Id">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_@modulo.Id" aria-expanded="false" aria-controls="collapse_@modulo.Id">
                                        @modulo.Titulo
                                    </button>
                                </h2>
                                <div id="collapse_@modulo.Id" class="accordion-collapse collapse" aria-labelledby="heading_@modulo.Id" data-bs-parent="#acordeonModulos">
                                    <div class="accordion-body p-0">
                                        <ul class="list-group list-group-flush">
                                            @if (modulo.Lecciones != null && modulo.Lecciones.Any())
                                            {
                                                @foreach (var leccion in modulo.Lecciones)
                                                {
                                                    <li class="list-group-item">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <i class="fas fa-play-circle text-primary me-2"></i>
                                                            <h5 class="mb-0">@leccion.Titulo</h5>
                                                        </div>
                                                        @if (!string.IsNullOrEmpty(leccion.UrlVideo))
                                                        {
                                                            <div class="ratio ratio-16x9 my-3">
                                                                <iframe src="@leccion.UrlVideo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                                            </div>
                                                        }
                                                        <p>@Html.Raw(leccion.Contenido)</p>
                                                    </li>
                                                }
                                            }
                                            else
                                            {
                                                <li class="list-group-item text-muted">No hay lecciones en este módulo.</li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="alert alert-warning text-center">
                            <i class="fas fa-exclamation-triangle me-2"></i>Este curso no contiene módulos ni lecciones.
                        </div>
                    }
                </div>
            }
        </div>
    </div>
</div>
